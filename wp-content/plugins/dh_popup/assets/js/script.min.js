!function(){function t(t,o){o=o||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,o.bubbles,o.cancelable,o.detail),e}"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,window.CustomEvent=t)}();var DHPopup=window.DHPopup||{};!function(s){DHPopup.timeoutOpen=null,DHPopup.timeoutClose=null,DHPopup.submitting=!1,DHPopup.currentUpdateStats=!1,DHPopup.scrollPopupDisplayed=!1,DHPopup.timerInactivity=0,DHPopup.intervalInactivity=null,DHPopup.tracking=function(t,o,e,p){if(parseInt(dhvcPopupSetting.ga_tracking)){p=p||1;try{"object"==typeof _gaq?_gaq.push(["_trackEvent",t,o,e,p,!1]):"function"==typeof _trackEvent?_trackEvent(t,o,e,p,!1):"function"==typeof __gaTracker?__gaTracker("send","event",t,o,e,p):"function"==typeof ga&&ga("send","event",t,o,e,p)}catch(t){}}},DHPopup.updateStats=function(t,o,e){if(!DHPopup.currentUpdateStats)return DHPopup.currentUpdateStats=!0,s.post(dhvcPopupSetting.ajax_url,{action:"dh_popup_update_stats_ajax",type:e,object_id:t,campaign_id:o,nonce:dhvcPopupSetting.nonce},function(){DHPopup.currentUpdateStats=!1})},DHPopup.initEvents=function(){s('.dh-popup[data-open_type="load"]').length&&s('.dh-popup[data-open_type="load"]').each(function(){var t=s(this);"show"!==DHPopup.getCookies(t.data("id"))&&DHPopup.openPopUp(t)}),s('.dh-popup[data-open_type="scroll"]').length&&s(window).on("scroll",function(){var t,o,e;DHPopup.scrollPopupDisplayed||(t=s(document).height()-s(window).height(),o=s(window).scrollTop(),e=parseInt(o/t*100,10),s('.dh-popup[data-open_type="scroll"]').each(function(){var t=s(this);e>=parseInt(t.data("scroll_offset"),10)&&"show"!==DHPopup.getCookies(t.data("id"))&&(DHPopup.openPopUp(t),DHPopup.scrollPopupDisplayed=!0)}))}),s('.dh-popup[data-open_type="inactivity"]').length&&(DHPopup.intervalInactivity&&clearInterval(DHPopup.intervalInactivity),DHPopup.intervalInactivity=setInterval(function(){DHPopup.timerInactivity++,console.log(DHPopup.timerInactivity),s('.dh-popup[data-open_type="inactivity"]').each(function(){var t=s(this);DHPopup.timerInactivity>parseInt(t.data("inactivity_seconds"),10)&&"show"!==DHPopup.getCookies(t.data("id"))&&(console.log("open"),DHPopup.openPopUp(t))}),DHPopup.timerInactivity>parseInt(dhvcPopupSetting.max_inactivity_timer_interval)&&DHPopup.intervalInactivity&&clearInterval(DHPopup.intervalInactivity)},1e3),s(document).on("mousemove",function(t){DHPopup.timerInactivity=0}),s(document).on("keypress",function(t){DHPopup.timerInactivity=0})),s("body").find('[href^="#popup_open_"],[data-popup-open]').each(function(){s(this).on("click",function(t){t.stopPropagation(),t.preventDefault();t=(t=s(this).data("popup-open"))||(t=(t=s(this).attr("href"))&&t.replace(/.*(?=#[^\s]*$)/,"")).replace("#popup_open_","");DHPopup.openPopUp("#dh_popup_"+t,!0)})}),s("body").find('.dh_popup_close,[href="#popup_close"]').each(function(){s(this).on("click",function(t){t.stopPropagation(),t.preventDefault(),s.fancybox&&s.fancybox.isOpen&&s.fancybox.close()})}),s("body").find('[href^="#not_show_popup_again_"],[data-not_show_popup_again]').each(function(){s(this).on("click",function(t){t.stopPropagation(),t.preventDefault();t=(t=s(this).data("not_show_popup_again"))||(t=(t=s(this).attr("href"))&&t.replace(/.*(?=#[^\s]*$)/,"")).replace("#not_show_popup_again_","");DHPopup.setCookies(t,parseInt(dhvcPopupSetting.interval_show_popup_again)),s.fancybox.close()})})},DHPopup.setCookies=function(t,o){return o=o||"",Cookies.set(dhvcPopupSetting.cookie_prefix+t,"show",{expires:o,path:"/"})},DHPopup.getCookies=function(t){return(!window.dh_popup_preview||!0!==window.dh_popup_preview)&&Cookies.get(dhvcPopupSetting.cookie_prefix+t)},DHPopup.afterShowPopup=function(t){var o=s(t);switch(o.data("open_mode")){case"once-session":DHPopup.setCookies(o.data("id"),0);break;case"once-period":case"once-session":o.attr("data-open_interval")&&DHPopup.setCookies(o.data("id"),parseInt(openinterval))}},DHPopup.getViewport=function(){var t=window,o="inner";return"innerWidth"in window||(o="client",t=document.documentElement||document.body),{width:t[o+"Width"],height:t[o+"Height"]}},DHPopup.updatePopup=function(t){var o=s(t),e=DHPopup.getViewport();parseInt(o.data("hide_mobile"))&&e.width<=767&&s.fancybox.close();var p=o.data("width"),t=o.data("height"),t=Math.min(e.width/p,e.height/t);1<(t-=.03)&&(t=1),(parseInt(o.data("disable_responsive"))||"yes"===o.data("use_css_responsive")&&e.width<=767)&&(t=1);var a="";switch(o.data("position")){case"center-bottom":case"center-top":a="translate(-50%,0) ";break;case"left-center":case"right-center":a="translate(0,-50%) ";break;case"center":a="translate(-50%,-50%) "}e=o.data("position").replace("-"," ");o.closest(".dh-popup__wrap").css({transform:a+"scale("+t+")","-ms-transform":a+"scale("+t+")","-webkit-transform":a+"scale("+t+")","-ms-transform-origin":e,"transform-origin":e,"-webkit-transform-origin":e})},DHPopup.openPopUp=function(t,o){o=o||!1;var e,p,a=DHPopup.getViewport(),n=this,i=s(t);parseInt(s(t).data("hide_mobile"))&&a.width<=767?s.fancybox.close():void 0!==s.fancybox&&(s.fancybox.isOpen||(a={},e="yes"===i.data("use_css_responsive"),"image"===i.data("overlay_type")&&(a.background="url("+i.data("overlay_image")+")"),p={helpers:{overlay:"disable"===i.data("overlay_type")?null:{locked:!1,closeClick:!parseInt(i.data("disable_overlay_click")),showEarly:!1,speedOut:5,css:a}},tpl:{closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"><i class="fancybox-close__line-top"></i><i class="fancybox-close__line-bottom"></i></a>'},width:"auto",openEffect:"none",autoHeight:!0,padding:0,titleShow:!1,arrows:!1,autoCenter:!1,closeBtn:!i.data("hide_close_button"),wrapCSS:"dh-popup__wrap dh-popup__wrap--"+i.data("id")+" dh-popup__wrap--"+i.data("position")+(e?" dh-popup__wrap--use-css-responsive":""),beforeClose:function(){DHPopup.triggerEvent(i,"beforeClosePopup",i)},afterClose:function(){n.timeoutClose&&clearTimeout(n.timeoutClose),DHPopup.triggerEvent(i,"afterClosePopup",i),e&&s(document.body).removeClass("dh-popup-open")},beforeShow:function(){var t=i.data("campaign_id")?i.data("campaign_id"):0;DHPopup.updateStats(i.data("id"),t,"impressions"),DHPopup.tracking("popup","open",i.data("id")),i.find(".dh_popup_field__text").each(function(){s(this).val("")}),e&&s(document.body).addClass("dh-popup-open"),DHPopup.triggerEvent(i,"beforeOpenPopup",i)},afterShow:function(){DHPopup.afterShowPopup(i);var t=i.data("close_delay");t&&(n.timeoutClose&&clearTimeout(n.timeoutClose),n.timeoutClose=setTimeout(function(){s.fancybox.close()},1e3*parseInt(t,10))),DHPopup.triggerEvent(i,"afterOpenPopup",i)},onUpdate:function(){DHPopup.updatePopup(i)}},parseInt(i.data("disable_responsive"))||(p.fitToView=!1,p.autoCenter=!1,p.autoSize=!1,p.autoResize=!1,p.margin=0,p.wrapCSS=p.wrapCSS+" dh_popup_responsive"),a=i.data("open_delay"),!1===o&&a?(n.timeoutOpen&&clearTimeout(n.timeoutOpen),n.timeoutOpen=setTimeout(function(){s.fancybox.open(i,p)},1e3*parseInt(a,10))):s.fancybox.open(i,p)))},DHPopup.clearResponse=function(t){t=s(t);s(".dh_popup_not_valid_tip",t).remove(),t.removeClass("invalid sent failed"),s("[aria-invalid]",t).attr("aria-invalid","false"),s(".dh_popup__form-control",t).removeClass("dh_popup--not-valid")},DHPopup.triggerEvent=function(t,o,e){var p=s(t),t=new CustomEvent("dhpopup"+o,{bubbles:!0,detail:e});p.get(0).dispatchEvent(t),p.trigger("dhpopup:"+o,e)},DHPopup.initSubmit=function(t){var o=s(t);o.on("submit",function(t){return t&&(t.stopPropagation(),t.preventDefault()),DHPopup.submitForm(o),!1})},DHPopup.notValidTip=function(t,o){t=s(t);s(".dh_popup_not_valid_tip",t.parent()).remove(),s('<span role="alert" class="dh_popup_not_valid_tip"></span>').text(o).appendTo(t.parent()).show()},DHPopup.submitForm=function(t){var a=this;if(a.submitting)return!1;a.submitting=!0;var p=s(t);DHPopup.clearResponse(p),p.find(".dh-popup-form-response").empty().hide();t=p.serialize();s.ajax({type:"POST",url:dhvcPopupSetting.ajax_url,data:t,dataType:"json"}).done(function(t,o,e){DHPopup.tracking("popup","subscribe",p.closest(".dh-popup").data("id")),function(t,e){var o={id:s(t.into).attr("id"),status:t.status};switch(t.action_status){case"validation_failed":s.each(t.invalidFields,function(t,o){s(".dh_popup_field__group--"+o.field,e).each(function(){DHPopup.notValidTip(this,o.message),s(".dh_popup__form-control",this).addClass("dh_popup--not-valid"),s("[aria-invalid]",this).attr("aria-invalid","true")})}),e.addClass("invalid"),DHPopup.triggerEvent(e,"invalidForm",o);break;case"unknown_error":case"error_config":case"action_error":t.message&&e.find(".dh-popup-form-response").removeClass("is-error is-success").addClass("is-error").html(t.message).show();break;case"submit_success":case"subscribe_success":t.message&&e.find(".dh-popup-form-response").removeClass("is-error is-success").addClass("is-success").html(t.message).show(),"success"===s(t.into).data("close_type")&&(a.timeoutClose&&clearTimeout(a.timeoutClose),a.timeoutClose=setTimeout(function(){s.fancybox.close()},5e3)),DHPopup.setCookies(s(t.into).attr("id"),parseInt(dhvcPopupSetting.interval_show_popup_again));var p=s(t.into).data("redirect_url");""!==p&&(window.location.href=p)}DHPopup.triggerEvent(e,"submitForm",o)}(t,p),a.submitting=!1}).fail(function(t,o,e){a.submitting=!1,DHPopup.triggerEvent(p,"submitFail",p)})},s("div.dh-popup__inner > form").each(function(){var t=s(this);DHPopup.initSubmit(t)}),s("button",s(".dhvc-popup-submit")).on("click",function(t){t.stopPropagation(),t.preventDefault(),s(this).closest("form").submit()}),s(document).ready(function(){DHPopup.initEvents()})}(jQuery);